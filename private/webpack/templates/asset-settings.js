const path = require('path');

const assetSettingsTemplate = ({ htmlWebpackPlugin }, project, mode) => `<?php
/**
 * @file - Asset settings generated by webpack.
 *
 * WARNING: Do not edit this file!
 * It will be created and updated automatically whenever new assets are created.
 */

${htmlWebpackPlugin.files.js
  .concat(htmlWebpackPlugin.files.css)
  .map(file => {
    const parsedFile = path.parse(file);

    let name = parsedFile.name.replace(/-/g, '_').toUpperCase();
    let ext  = parsedFile.ext.split('.')[1].toUpperCase()
    if (mode === 'production' && ext !== 'CSS') {
      const splitName = name.split('_');
      splitName.pop();
      name = splitName.join('_');
    }

    return `define( '${project.replace(/-/g, '_').toUpperCase()}_${name}_${ext}', '${parsedFile.base}' );
`;
  })
  .join(``)}
`;

module.exports = assetSettingsTemplate;
